<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cpr">
<title>Tensor Products of B-Splines, Control Nets, and Control Net Reduction â€¢ cpr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tensor Products of B-Splines, Control Nets, and Control Net Reduction">
<meta property="og:description" content="cpr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9006</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cpr.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/cnr.html">Tensor Products of B-Splines, Control Nets, and Control Net Reduction</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dewittpe/cpr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Tensor Products of B-Splines, Control Nets, and Control Net Reduction</h1>
                        <h4 data-toc-skip class="author">Peter E.
DeWitt</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dewittpe/cpr/blob/HEAD/vignettes/cnr.Rmd" class="external-link"><code>vignettes/cnr.Rmd</code></a></small>
      <div class="d-none name"><code>cnr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dewittpe/cpr/" class="external-link">cpr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"cpr"</span><span class="op">)</span></span>
<span><span class="co">## [1] '0.3.0.9006'</span></span></code></pre></div>
<p>The control polygon reduction methods for uni-variable functions can
be extended to multi-variable functions by generalizing control polygons
to control nets.</p>
<div class="section level2">
<h2 id="tensor-products-of-b-splines">Tensor Products of B-Splines<a class="anchor" aria-label="anchor" href="#tensor-products-of-b-splines"></a>
</h2>
<p>Where uni-variable functions of B-splines:</p>
<p><span class="math display">\[\begin{equation}
  f \left( x \right) =
  \sum_{j} \theta_j B_{j,k,\boldsymbol{\xi}}\left(x\right) =
  \boldsymbol{B}_{k, \boldsymbol{\xi}} \left(x\right)
\boldsymbol{\theta}_{\boldsymbol{\xi}}
  \label{eq:f}
\end{equation}\]</span></p>
<p>we extend to multi-variable <span class="math inline">\(m\)</span>-dimensional B-spline function, built on
<span class="math inline">\(m\)</span> B-spline basis matrices <span class="math inline">\(\boldsymbol{B}_{k_1, \boldsymbol{\xi}_1}
\left(x_1\right),\)</span> <span class="math inline">\(\boldsymbol{B}_{k_2, \boldsymbol{\xi}_2}
\left(x_2\right), \ldots,\)</span> <span class="math inline">\(\boldsymbol{B}_{k_m, \boldsymbol{\xi}_m}
\left(x_m\right),\)</span> as</p>
<p><span class="math display">\[\begin{equation}
  f \left( \boldsymbol{X} \right) =
  \mathscr{B}_{\boldsymbol{K}, \boldsymbol{\Xi}} \left( \boldsymbol{X}
\right)
  \boldsymbol{\theta}_{\boldsymbol{\Xi}}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{K} = \left\{k_1, k_2,
\ldots, k_m\right\},\)</span> denotes the set of polynomial orders,
<span class="math inline">\(\boldsymbol{\Xi} = \left\{
\boldsymbol{\xi}_1, \boldsymbol{\xi}_2, \ldots, \boldsymbol{\xi}_m
\right\}\)</span> is the set of knot sequences, and <span class="math inline">\(\boldsymbol{\theta}_{\boldsymbol{\Xi}}\)</span> is
a <span class="math inline">\(\prod_{i = 1}^{m} \left( \left\lvert
\boldsymbol{\xi}_i \right\rvert - k_i \right) \times 1\)</span> column
vector of regression coefficients, and <span class="math inline">\(\boldsymbol{X}\)</span> is the observed data:</p>
<p><span class="math display">\[\begin{equation}
  \boldsymbol{X} = \begin{pmatrix}
    x_{11} &amp; x_{21} &amp; \cdots &amp; x_{m1} \\
    x_{12} &amp; x_{22} &amp; \cdots &amp; x_{m2} \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    x_{12} &amp; x_{22} &amp; \cdots &amp; x_{mn}
  \end{pmatrix}.
\end{equation}\]</span></p>
<p>The basis for multi-variable B-splines is constructed by a recursive
algorithm. The base case for <span class="math inline">\(m = 2\)</span>
is <span class="math display">\[\begin{equation}
  \label{eq:tensor_product_base_case}
  \mathscr{B}_{ \left\{k_1, k_2\right\}, \left\{ \boldsymbol{\xi}_1,
  \boldsymbol{\xi}_2 \right\}} \left( \boldsymbol{x}_1, \boldsymbol{x}_2
\right) =
  \left(\boldsymbol{1}^T_{\left\lvert{\boldsymbol{\xi}_2}\right\rvert -
k_2} \otimes
  \boldsymbol{B}_{k_1, \boldsymbol{\xi}_1} \left(\boldsymbol{x}_1
\right)  \right) \odot
  \left(\boldsymbol{B}_{k_2, \boldsymbol{\xi}_2} \left( \boldsymbol{x}_2
\right) \otimes
  \boldsymbol{1}^{T}_{\left\lvert{\boldsymbol{\xi}_1}\right\rvert - k_1}
\right),
\end{equation}\]</span> where <span class="math inline">\(\odot\)</span>
is the element-wise product, <span class="math inline">\(\otimes\)</span> is a Kronecker product, and <span class="math inline">\(\boldsymbol{1}_n\)</span> is a <span class="math inline">\(n \times 1\)</span> column vector of 1s. The two
Kronecker products define the correct dimensions for the entry-wise
product. The tensor product matrix has the same number of rows as the
two input matrices and the columns are generated by all the pairwise
products of the columns of the two input matrices. The general case for
<span class="math inline">\(m &gt; 2,\)</span> the matrix <span class="math inline">\(\mathscr{B}_{\boldsymbol{K}, \boldsymbol{\Xi}}
\left( \boldsymbol{X} \right)\)</span> is defined by <span class="math display">\[\begin{equation}
    \mathscr{B}_{\boldsymbol{K}, \boldsymbol{\Xi}} \left( \boldsymbol{X}
\right) =
    \left( \boldsymbol{1}_{\left\lvert{\boldsymbol{\xi}_m}\right\rvert -
k_m}^{T} \otimes
    \mathscr{B}_{\boldsymbol{K} \backslash
  k_{m}, \boldsymbol{\Xi} \backslash \boldsymbol{\xi}_m}
\left(\boldsymbol{X}
  \backslash \boldsymbol{x}_{m} \right) \right)
    \odot
    \left( \boldsymbol{B}_{k_m,
\boldsymbol{\xi}_m}\left(\boldsymbol{x}_m\right) \otimes
    \boldsymbol{1}_{\prod_{i = 1}^{m-1}
    \left(\left\lvert{\boldsymbol{\xi}_i}\right\rvert - k_i \right)}^{T}
  \right).
\end{equation}\]</span></p>
<p>It is possible to write the above as a set of summations: <span class="math display">\[\begin{equation}
  \begin{split}
    f\left( \boldsymbol{X} \right) &amp; = \mathscr{B}_{\boldsymbol{K},
\boldsymbol{\Xi}} \left( \boldsymbol{X} \right)
\boldsymbol{\theta}_{\boldsymbol{\Xi}} \\
   &amp; =
    \sum_{j_1 = 1}^{\left\lvert{\boldsymbol{\xi}_1}\right\rvert - k_1}
    \sum_{j_2 = 1}^{\left\lvert{\boldsymbol{\xi}_2}\right\rvert - k_2}
  \cdots
  \sum_{j_m = 1}^{\left\lvert{\boldsymbol{\xi}_m}\right\rvert - k_m}
  \boldsymbol{B}_{k_1, \boldsymbol{\xi}_1}\left(\boldsymbol{x}_1\right)
  \boldsymbol{B}_{k_2, \boldsymbol{\xi}_2}\left(\boldsymbol{x}_2\right)
  \cdots
  \boldsymbol{B}_{k_m, \boldsymbol{\xi}_m}\left(\boldsymbol{x}_m\right)
  \theta_{\boldsymbol{\Xi}, j_1, j_2, \ldots, j_m} \\
  &amp; =
    \sum_{j_1 = 1}^{\left\lvert{\boldsymbol{\xi}_1}\right\rvert - k_1}
    \boldsymbol{B}_{k_1,\boldsymbol{\xi}_1}\left(\boldsymbol{x}_1\right)
  \underbrace{
    \sum_{j_2 = 1}^{\left\lvert{\boldsymbol{\xi}_2}\right\rvert - k_2}
  \cdots
  \sum_{j_m = 1}^{\left\lvert{\boldsymbol{\xi}_m}\right\rvert - k_m}
  \boldsymbol{B}_{k_2,\boldsymbol{\xi}_2}\left(\boldsymbol{x}_2\right)
  \cdots
  \boldsymbol{B}_{k_m,\boldsymbol{\xi}_m}\left(\boldsymbol{x}_m\right)
  \theta_{\boldsymbol{\Xi}, j_1, j_2, \ldots, j_m}
  }_{\text{polynomial coefficients}} \\
  &amp; =
  \text{diag}\left(
  \boldsymbol{B}_{k_1, \boldsymbol{\xi}_1} \left(\boldsymbol{x}_1\right)
  \boldsymbol{\theta}_{\boldsymbol{\Xi}\backslash
  \boldsymbol{\xi}_1} \left( \boldsymbol{X} \backslash \boldsymbol{x}_1
\right)\right).
  \end{split}
\end{equation}\]</span> This is critical in the extension from the
uni-variable control polygon reduction method to the multi-variable
control polygon reduction method. By conditioning on <span class="math inline">\(m-1\)</span> marginals, the multi-variable
B-spline becomes a uni-variable B-spline in terms of the <span class="math inline">\(m^{th}\)</span> marginal. Thus, the metrics and
methods of control polygon reduction can be applied.</p>
</div>
<div class="section level2">
<h2 id="control-nets">Control Nets<a class="anchor" aria-label="anchor" href="#control-nets"></a>
</h2>
<p>For multi-variable B-splines, a meaningful geometric relationship
between the set of knot sequences, <span class="math inline">\(\boldsymbol{\Xi},\)</span> and regression
coefficients, <span class="math inline">\(\boldsymbol{\theta}_{\boldsymbol{\Xi}},\)</span>
is provided by a control net. A control net for <span class="math inline">\(m = 2\)</span> variables would be: <span class="math display">\[\begin{equation}
  {CN}_{\boldsymbol{K} = \left\{k_1, k_2\right\}, \boldsymbol{\Xi} =
\left\{
  \boldsymbol{\xi}_1,
  \boldsymbol{\xi}_2 \right\}, \boldsymbol{\theta}_{\boldsymbol{\Xi}}} =
\left\{ \left( \xi_{1i}^{*},
  \xi_{2j}^{*}, \theta_{ij} \right) \right\}_{i = 1, j =
  1}^{\left\lvert{\boldsymbol{\xi}_1}\right\rvert -
    k_1,
  \left\lvert{\boldsymbol{\xi}_2}\right\rvert - k_2}, \quad \xi^{*}_{lj}
= \frac{1}{k_l + 1} \sum_{i = 1}^{k_l - 1}
  \xi_{l, j + i}.
\end{equation}\]</span></p>
<p>Building a control net in the cpr package is done by calling the
<code>cn</code> function after defining a basis via the
<code>btensor</code> method.</p>
<p>Define a tensor product of B-splines by providing a list of vectors,
iknots, bknots, and orders.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tpmat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/btensor.html">btensor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">51</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">51</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          iknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.418</span>, <span class="fl">0.582</span>, <span class="fl">0.676</span>, <span class="fl">0.840</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          bknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tpmat</span></span>
<span><span class="co">## Tensor Product Matrix dims: [51 x 24]</span></span></code></pre></div>
<p>An example of a control net and the surface it produces:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.03760</span>,  <span class="fl">0.03760</span>, <span class="op">-</span><span class="fl">0.03760</span>,  <span class="fl">0.77579</span>, <span class="op">-</span><span class="fl">0.84546</span>,  <span class="fl">0.63644</span>, <span class="op">-</span><span class="fl">0.87674</span>,</span>
<span>     <span class="fl">0.71007</span>, <span class="op">-</span><span class="fl">1.21007</span>,  <span class="fl">0.29655</span>, <span class="op">-</span><span class="fl">0.57582</span>, <span class="op">-</span><span class="fl">0.26198</span>,  <span class="fl">0.23632</span>, <span class="op">-</span><span class="fl">0.58583</span>,</span>
<span>    <span class="op">-</span><span class="fl">0.46271</span>, <span class="op">-</span><span class="fl">0.39724</span>, <span class="op">-</span><span class="fl">0.02194</span>, <span class="op">-</span><span class="fl">1.23562</span>, <span class="op">-</span><span class="fl">0.19377</span>, <span class="op">-</span><span class="fl">0.27948</span>, <span class="op">-</span><span class="fl">1.14028</span>,</span>
<span>     <span class="fl">0.00405</span>, <span class="op">-</span><span class="fl">0.50405</span>, <span class="op">-</span><span class="fl">0.99595</span><span class="op">)</span></span>
<span></span>
<span><span class="va">acn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cn.html">cn</a></span><span class="op">(</span><span class="va">tpmat</span>, <span class="va">theta</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">acn</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"x2"</span>, zlab <span class="op">=</span> <span class="st">"control net"</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</span></span>
<span><span class="co">## Warning: 'rgl.init' failed, running with 'rgl.useNULL = TRUE'.</span></span>
<span><span class="co">## Warning: no DISPLAY variable so Tk is not available</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">acn</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"x2"</span>, zlab <span class="op">=</span> <span class="st">"surface"</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnr_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="control-net-reduction">Control Net Reduction<a class="anchor" aria-label="anchor" href="#control-net-reduction"></a>
</h2>
<p>Similar to control polygon reduction (CPR), control net reduction
(CNR) looks assesses the influence of each internal knot, omits the
least influential, refits the model, and repeats. A complication for CNR
is that the influence of an internal knot on margin <span class="math inline">\(m\)</span> is a function of the locations values
of <span class="math inline">\(x\)</span> on the other margins defining
the polynomial coefficients. We suggest using a set of <span class="math inline">\(p=20\)</span> values on each margin for
assessment.</p>
<p>For example in a two-variable tensor product, the influence weight of
the <span class="math inline">\(j^{th}\)</span> internal knot for the
first margin is</p>
<p><span class="math display">\[w_{1j} = \max_{x_2 \in \boldsymbol{U}}
w_{\left. 1j \right| x_2},\]</span> where <span class="math display">\[\boldsymbol{U} =
\left\{ u :  \min\left(x_2\right) +
\frac{\left\{1,2,\ldots,p\right\}}{p+1} \left( \max\left(x_2\right) -
\min\left(x_2\right)\right)
\right\}
\]</span></p>
<p>For example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">{</span><span class="op">(</span><span class="va">x1</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">cn_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cn_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">cn_data</span>, <span class="op">{</span><span class="va">z</span> <span class="op">=</span> <span class="fu">f</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">initial_cn</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/cn.html">cn</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="fu"><a href="../reference/btensor.html">btensor</a></span><span class="op">(</span>x        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span>
<span>                 , iknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.234</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.418</span>, <span class="fl">0.582</span>, <span class="fl">0.676</span>, <span class="fl">0.840</span><span class="op">)</span><span class="op">)</span></span>
<span>                 , bknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>                 , order  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span>     , data <span class="op">=</span> <span class="va">cn_data</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/influence_of_iknots.html">influence_of_iknots</a></span><span class="op">(</span><span class="va">initial_cn</span><span class="op">)</span></span>
<span><span class="co">## [[1]]</span></span>
<span><span class="co">##         xi_4 </span></span>
<span><span class="co">## 5.282465e-32 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##        xi_5        xi_6        xi_7        xi_8 </span></span>
<span><span class="co">## 0.717424005 0.045575415 0.006775287 0.012875249 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "cpr_influence_of_iknots_cpn" "list"</span></span></code></pre></div>
<p>The least influential knot is <span class="math inline">\(\xi_{1,4}\)</span> and the most influential knot
is <span class="math inline">\(\xi_{2,5}.\)</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_bsplines.html">update_btensor</a></span><span class="op">(</span><span class="va">initial_cn</span>, iknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.418</span>, <span class="fl">0.582</span>, <span class="fl">0.676</span>, <span class="fl">0.840</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_bsplines.html">update_btensor</a></span><span class="op">(</span><span class="va">initial_cn</span>, iknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0.234</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.582</span>, <span class="fl">0.676</span>, <span class="fl">0.840</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">initial_cn</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Original"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cn1</span>,        rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">Omitting</span><span class="op">~</span><span class="va">xi</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cn2</span>,        rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">Omitting</span><span class="op">~</span><span class="va">xi</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnr_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>A call to <code>cnr</code> runs the full CNR algorithm on an initial
control net.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cnr0 <span class="ot">&lt;-</span> <span class="fu">cnr</span>(initial_cn)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="er">|</span>                                                                      <span class="er">|</span>   <span class="dv">0</span>%</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="er">|============</span>                                                          <span class="er">|</span>  <span class="dv">17</span>%</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="er">|=======================</span>                                               <span class="er">|</span>  <span class="dv">33</span>%</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===================================</span>                                   <span class="er">|</span>  <span class="dv">50</span>%</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="er">|===============================================</span>                       <span class="er">|</span>  <span class="dv">67</span>%</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="er">|==========================================================</span>            <span class="er">|</span>  <span class="dv">83</span>%</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|</span>                                                                            </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="er">|======================================================================|</span> <span class="dv">100</span>%</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cnr0)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="do">##   dfs   loglik        rss         rse n_iknots1 iknots1 n_iknots2      iknots2</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 1  12 12396.78 49.0631393 0.070087150         0                 0             </span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 2  15 12408.53 48.9479832 0.070015367         0                 1        0.582</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 3  18 36554.82  0.3912139 0.006260346         0                 2 0.418, 0.582</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 4  21 36559.88  0.3908179 0.006258118         0                 3 0.418, 0....</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 5  24 38449.23  0.2678356 0.005181505         0                 4 0.418, 0....</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 6  32 38449.23  0.2678356 0.005183584         1   0.234         4 0.418, 0....</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   index</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1</span></span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2</span></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3</span></span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     4</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     5</span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     6</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cnr0)</span></code></pre></div>
<p><img src="cnr_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The plot of the residual standard errors by index shows index 3 is
the preferable model. We can look at all the surfaces and see there is
little difference from the original (index 6) through index 3 with
considerable differences in the surfaces for index 1 and 2.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 1"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 2"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 3"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 4"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 5"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 6"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnr_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs">

</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] cpr_0.3.0.9006 qwraps2_0.6.0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] generics_0.1.3    utf8_1.2.4        sass_0.4.8        tcltk_4.3.2      </span></span>
<span><span class="co">##  [5] stringi_1.8.3     lattice_0.21-9    lme4_1.1-35.1     digest_0.6.33    </span></span>
<span><span class="co">##  [9] magrittr_2.0.3    rgl_1.2.8         evaluate_0.23     grid_4.3.2       </span></span>
<span><span class="co">## [13] fastmap_1.1.1     jsonlite_1.8.8    Matrix_1.6-4      misc3d_0.9-1     </span></span>
<span><span class="co">## [17] fansi_1.0.6       purrr_1.0.2       scales_1.3.0      textshaping_0.3.7</span></span>
<span><span class="co">## [21] jquerylib_0.1.4   cli_3.6.2         rlang_1.1.2       munsell_0.5.0    </span></span>
<span><span class="co">## [25] splines_4.3.2     withr_2.5.2       base64enc_0.1-3   cachem_1.0.8     </span></span>
<span><span class="co">## [29] yaml_2.3.8        tools_4.3.2       memoise_2.0.1     nloptr_2.0.3     </span></span>
<span><span class="co">## [33] dplyr_1.1.4       minqa_1.2.6       colorspace_2.1-0  ggplot2_3.4.4    </span></span>
<span><span class="co">## [37] boot_1.3-28.1     vctrs_0.6.5       R6_2.5.1          lifecycle_1.0.4  </span></span>
<span><span class="co">## [41] plot3D_1.4        stringr_1.5.1     fs_1.6.3          htmlwidgets_1.6.4</span></span>
<span><span class="co">## [45] MASS_7.3-60       ragg_1.2.7        pkgconfig_2.0.3   desc_1.4.3       </span></span>
<span><span class="co">## [49] pillar_1.9.0      pkgdown_2.0.7     bslib_0.6.1       gtable_0.3.4     </span></span>
<span><span class="co">## [53] glue_1.6.2        Rcpp_1.0.11       systemfonts_1.0.5 tidyselect_1.2.0 </span></span>
<span><span class="co">## [57] tibble_3.2.1      xfun_0.41         highr_0.10        knitr_1.45       </span></span>
<span><span class="co">## [61] farver_2.1.1      htmltools_0.5.7   nlme_3.1-163      labeling_0.4.3   </span></span>
<span><span class="co">## [65] rmarkdown_2.25    compiler_4.3.2</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peter DeWitt.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
