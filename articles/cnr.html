<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Tensor Products of B-Splines, Control Nets, and Control Net Reduction â€¢ cpr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Tensor Products of B-Splines, Control Nets, and Control Net Reduction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cpr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/cpr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/cnr.html">Tensor Products of B-Splines, Control Nets, and Control Net Reduction</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dewittpe/cpr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Tensor Products of B-Splines, Control Nets, and Control Net Reduction</h1>
                        <h4 data-toc-skip class="author">Peter E.
DeWitt</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dewittpe/cpr/blob/main/vignettes/cnr.Rmd" class="external-link"><code>vignettes/cnr.Rmd</code></a></small>
      <div class="d-none name"><code>cnr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dewittpe/cpr/" class="external-link">cpr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"cpr"</span><span class="op">)</span></span>
<span><span class="co">## [1] '0.4.1'</span></span></code></pre></div>
<p>The control polygon reduction methods for univariate functions can be
extended to multivariate functions by generalizing control polygons to
control nets.</p>
<div class="section level2">
<h2 id="tensor-products-of-b-splines">Tensor Products of B-Splines<a class="anchor" aria-label="anchor" href="#tensor-products-of-b-splines"></a>
</h2>
<p>For univariate B-splines:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munder><mo>âˆ‘</mo><mi>j</mi></munder><msub><mi>Î¸</mi><mi>j</mi></msub><msub><mi>B</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>ğ›</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>ğ</mi><mrow><mi>k</mi><mo>,</mo><mi>ğ›</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ›‰</mi><mi>ğ›</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  f \left( x \right) =
  \sum_{j} \theta_j B_{j,k,\boldsymbol{\xi}}\left(x\right) =
  \boldsymbol{B}_{k, \boldsymbol{\xi}} \left(x\right) \boldsymbol{\theta}_{\boldsymbol{\xi}}
  \label{eq:f}
\end{equation}</annotation></semantics></math></p>
<p>we extend to a multivariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>-dimensional
B-spline function, built on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
B-spline basis matrices
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{B}_{k_1, \boldsymbol{\xi}_1} \left(x_1\right),</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>â€¦</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{B}_{k_2, \boldsymbol{\xi}_2} \left(x_2\right), \ldots,</annotation></semantics></math><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>,</mo><msub><mi>ğ›</mi><mi>m</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{B}_{k_m, \boldsymbol{\xi}_m} \left(x_m\right),</annotation></semantics></math>
as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>â„¬</mi><mrow><mi>ğŠ</mi><mo>,</mo><mi>ğšµ</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ›‰</mi><mi>ğšµ</mi></msub></mrow><annotation encoding="application/x-tex">\begin{equation}
  f \left( \boldsymbol{X} \right) =
  \mathscr{B}_{\boldsymbol{K}, \boldsymbol{\Xi}} \left( \boldsymbol{X} \right)
  \boldsymbol{\theta}_{\boldsymbol{\Xi}}
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğŠ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>k</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>k</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{K} = \left\{k_1, k_2, \ldots, k_m\right\},</annotation></semantics></math>
denotes the set of polynomial orders,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğšµ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>ğ›</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>ğ›</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\Xi} = \left\{ \boldsymbol{\xi}_1,
\boldsymbol{\xi}_2, \ldots, \boldsymbol{\xi}_m \right\}</annotation></semantics></math>
is the set of knot sequences, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ğ›‰</mi><mi>ğšµ</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\theta}_{\boldsymbol{\Xi}}</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>Ã—</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\prod_{i =
1}^{m} \left( \left\lvert \boldsymbol{\xi}_i \right\rvert - k_i \right)
\times 1</annotation></semantics></math> column vector of regression
coefficients, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ğ—</mi><annotation encoding="application/x-tex">\boldsymbol{X}</annotation></semantics></math>
is the observed data:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ—</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>11</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>21</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹¯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹¯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>â‹®</mi></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹®</mi></mtd><mtd columnalign="center" style="text-align: center"><mo>â‹±</mo></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹®</mi></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mn>22</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><mi>â‹¯</mi></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>x</mi><mrow><mi>m</mi><mi>n</mi></mrow></msub></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
  \boldsymbol{X} = \begin{pmatrix}
    x_{11} &amp; x_{21} &amp; \cdots &amp; x_{m1} \\
    x_{12} &amp; x_{22} &amp; \cdots &amp; x_{m2} \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    x_{12} &amp; x_{22} &amp; \cdots &amp; x_{mn}
  \end{pmatrix}.
\end{equation}</annotation></semantics></math></p>
<p>The basis for multivariate B-splines is constructed by a recursive
algorithm. The base case for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m = 2</annotation></semantics></math>
is
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>â„¬</mi><mrow><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>ğ›</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">}</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ±</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mn>ğŸ</mn><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mn>2</mn></msub></mrow><mi>T</mi></msubsup><mo>âŠ—</mo><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>âŠ™</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âŠ—</mo><msubsup><mn>ğŸ</mn><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mn>1</mn></msub></mrow><mi>T</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:tensor_product_base_case}
  \mathscr{B}_{ \left\{k_1, k_2\right\}, \left\{ \boldsymbol{\xi}_1,
  \boldsymbol{\xi}_2 \right\}} \left( \boldsymbol{x}_1, \boldsymbol{x}_2 \right) =
  \left(\boldsymbol{1}^T_{\left\lvert{\boldsymbol{\xi}_2}\right\rvert - k_2} \otimes
  \boldsymbol{B}_{k_1, \boldsymbol{\xi}_1} \left(\boldsymbol{x}_1 \right)  \right) \odot
  \left(\boldsymbol{B}_{k_2, \boldsymbol{\xi}_2} \left( \boldsymbol{x}_2 \right) \otimes
  \boldsymbol{1}^{T}_{\left\lvert{\boldsymbol{\xi}_1}\right\rvert - k_1} \right),
\end{equation}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>âŠ™</mo><annotation encoding="application/x-tex">\odot</annotation></semantics></math>
is the element-wise product,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>âŠ—</mo><annotation encoding="application/x-tex">\otimes</annotation></semantics></math>
is a Kronecker product, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mn>ğŸ</mn><mi>n</mi></msub><annotation encoding="application/x-tex">\boldsymbol{1}_n</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>Ã—</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n \times 1</annotation></semantics></math>
column vector of 1s. The two Kronecker products define the correct
dimensions for the entry-wise product. The tensor product matrix has the
same number of rows as the two input matrices and the columns are
generated by all the pairwise products of the columns of the two input
matrices. The general case for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>&gt;</mo><mn>2</mn><mo>,</mo></mrow><annotation encoding="application/x-tex">m &gt; 2,</annotation></semantics></math>
the matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>â„¬</mi><mrow><mi>ğŠ</mi><mo>,</mo><mi>ğšµ</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathscr{B}_{\boldsymbol{K}, \boldsymbol{\Xi}} \left( \boldsymbol{X} \right)</annotation></semantics></math>
is defined by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>â„¬</mi><mrow><mi>ğŠ</mi><mo>,</mo><mi>ğšµ</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mn>ğŸ</mn><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mi>m</mi></msub></mrow><mi>T</mi></msubsup><mo>âŠ—</mo><msub><mi>â„¬</mi><mrow><mi>ğŠ</mi><mo>âˆ–</mo><msub><mi>k</mi><mi>m</mi></msub><mo>,</mo><mi>ğšµ</mi><mo>âˆ–</mo><msub><mi>ğ›</mi><mi>m</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo>âˆ–</mo><msub><mi>ğ±</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>âŠ™</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>,</mo><msub><mi>ğ›</mi><mi>m</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âŠ—</mo><msubsup><mn>ğŸ</mn><mrow><munderover><mo>âˆ</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow></munderover><mrow><mo stretchy="true" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>T</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
    \mathscr{B}_{\boldsymbol{K}, \boldsymbol{\Xi}} \left( \boldsymbol{X} \right) =
    \left( \boldsymbol{1}_{\left\lvert{\boldsymbol{\xi}_m}\right\rvert - k_m}^{T} \otimes
    \mathscr{B}_{\boldsymbol{K} \backslash
  k_{m}, \boldsymbol{\Xi} \backslash \boldsymbol{\xi}_m} \left(\boldsymbol{X}
  \backslash \boldsymbol{x}_{m} \right) \right)
    \odot
    \left( \boldsymbol{B}_{k_m, \boldsymbol{\xi}_m}\left(\boldsymbol{x}_m\right) \otimes
    \boldsymbol{1}_{\prod_{i = 1}^{m-1}
    \left(\left\lvert{\boldsymbol{\xi}_i}\right\rvert - k_i \right)}^{T}
  \right).
\end{equation}</annotation></semantics></math></p>
<p>It is possible to write the above as a set of summations:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>â„¬</mi><mrow><mi>ğŠ</mi><mo>,</mo><mi>ğšµ</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ›‰</mi><mi>ğšµ</mi></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mn>1</mn></msub></mrow></munderover><munderover><mo>âˆ‘</mo><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mn>2</mn></msub></mrow></munderover><mi>â‹¯</mi><munderover><mo>âˆ‘</mo><mrow><msub><mi>j</mi><mi>m</mi></msub><mo>=</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mi>m</mi></msub></mrow></munderover><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>â‹¯</mi><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>,</mo><msub><mi>ğ›</mi><mi>m</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Î¸</mi><mrow><mi>ğšµ</mi><mo>,</mo><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>j</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>j</mi><mi>m</mi></msub></mrow></msub></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><munderover><mo>âˆ‘</mo><mrow><msub><mi>j</mi><mn>1</mn></msub><mo>=</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mn>1</mn></msub></mrow></munderover><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><munder><munder><mrow><munderover><mo>âˆ‘</mo><mrow><msub><mi>j</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mn>2</mn></msub></mrow></munderover><mi>â‹¯</mi><munderover><mo>âˆ‘</mo><mrow><msub><mi>j</mi><mi>m</mi></msub><mo>=</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mi>m</mi></msub></mrow></munderover><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>2</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>2</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>â‹¯</mi><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mi>m</mi></msub><mo>,</mo><msub><mi>ğ›</mi><mi>m</mi></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mi>m</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>Î¸</mi><mrow><mi>ğšµ</mi><mo>,</mo><msub><mi>j</mi><mn>1</mn></msub><mo>,</mo><msub><mi>j</mi><mn>2</mn></msub><mo>,</mo><mi>â€¦</mi><mo>,</mo><msub><mi>j</mi><mi>m</mi></msub></mrow></msub></mrow><mo accent="true">âŸ</mo></munder><mtext mathvariant="normal">polynomial coefficients</mtext></munder></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mtext mathvariant="normal">diag</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ</mi><mrow><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><msub><mi>ğ›‰</mi><mrow><mi>ğšµ</mi><mo>âˆ–</mo><msub><mi>ğ›</mi><mn>1</mn></msub></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>ğ—</mi><mo>âˆ–</mo><msub><mi>ğ±</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
  \begin{split}
    f\left( \boldsymbol{X} \right) &amp; = \mathscr{B}_{\boldsymbol{K}, \boldsymbol{\Xi}} \left( \boldsymbol{X} \right) \boldsymbol{\theta}_{\boldsymbol{\Xi}} \\
   &amp; =
    \sum_{j_1 = 1}^{\left\lvert{\boldsymbol{\xi}_1}\right\rvert - k_1}
    \sum_{j_2 = 1}^{\left\lvert{\boldsymbol{\xi}_2}\right\rvert - k_2}
  \cdots
  \sum_{j_m = 1}^{\left\lvert{\boldsymbol{\xi}_m}\right\rvert - k_m}
  \boldsymbol{B}_{k_1, \boldsymbol{\xi}_1}\left(\boldsymbol{x}_1\right)
  \boldsymbol{B}_{k_2, \boldsymbol{\xi}_2}\left(\boldsymbol{x}_2\right)
  \cdots
  \boldsymbol{B}_{k_m, \boldsymbol{\xi}_m}\left(\boldsymbol{x}_m\right)
  \theta_{\boldsymbol{\Xi}, j_1, j_2, \ldots, j_m} \\
  &amp; =
    \sum_{j_1 = 1}^{\left\lvert{\boldsymbol{\xi}_1}\right\rvert - k_1}
    \boldsymbol{B}_{k_1,\boldsymbol{\xi}_1}\left(\boldsymbol{x}_1\right)
  \underbrace{
    \sum_{j_2 = 1}^{\left\lvert{\boldsymbol{\xi}_2}\right\rvert - k_2}
  \cdots
  \sum_{j_m = 1}^{\left\lvert{\boldsymbol{\xi}_m}\right\rvert - k_m}
  \boldsymbol{B}_{k_2,\boldsymbol{\xi}_2}\left(\boldsymbol{x}_2\right)
  \cdots
  \boldsymbol{B}_{k_m,\boldsymbol{\xi}_m}\left(\boldsymbol{x}_m\right)
  \theta_{\boldsymbol{\Xi}, j_1, j_2, \ldots, j_m}
  }_{\text{polynomial coefficients}} \\
  &amp; =
  \text{diag}\left(
  \boldsymbol{B}_{k_1, \boldsymbol{\xi}_1} \left(\boldsymbol{x}_1\right)
  \boldsymbol{\theta}_{\boldsymbol{\Xi}\backslash
  \boldsymbol{\xi}_1} \left( \boldsymbol{X} \backslash \boldsymbol{x}_1 \right)\right).
  \end{split}
\end{equation}</annotation></semantics></math> This is critical in the
extension from the univariate control polygon reduction method to the
multivariate control polygon reduction method. By conditioning on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">m-1</annotation></semantics></math>
marginals, the multivariate B-spline becomes a univariate B-spline in
terms of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>m</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">m^{th}</annotation></semantics></math>
marginal. Thus, the metrics and methods of control polygon reduction can
be applied.</p>
</div>
<div class="section level2">
<h2 id="control-nets">Control Nets<a class="anchor" aria-label="anchor" href="#control-nets"></a>
</h2>
<p>For multivariate B-splines, a meaningful geometric relationship
between the set of knot sequences,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğšµ</mi><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\Xi},</annotation></semantics></math>
and regression coefficients,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ğ›‰</mi><mi>ğšµ</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}_{\boldsymbol{\Xi}},</annotation></semantics></math>
is provided by a control net. A control net for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">m = 2</annotation></semantics></math>
variables would be:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow><mi>C</mi><mi>N</mi></mrow><mrow><mi>ğŠ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><msub><mi>k</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><mi>ğšµ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><msub><mi>ğ›</mi><mn>1</mn></msub><mo>,</mo><msub><mi>ğ›</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo><msub><mi>ğ›‰</mi><mi>ğšµ</mi></msub></mrow></msub><mo>=</mo><msubsup><mrow><mo stretchy="true" form="prefix">{</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>Î¾</mi><mrow><mn>1</mn><mi>i</mi></mrow><mo>*</mo></msubsup><mo>,</mo><msubsup><mi>Î¾</mi><mrow><mn>2</mn><mi>j</mi></mrow><mo>*</mo></msubsup><mo>,</mo><msub><mi>Î¸</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mn>1</mn></msub><mo>,</mo><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>ğ›</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>âˆ’</mo><msub><mi>k</mi><mn>2</mn></msub></mrow></msubsup><mo>,</mo><mspace width="1.0em"></mspace><msubsup><mi>Î¾</mi><mrow><mi>l</mi><mi>j</mi></mrow><mo>*</mo></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>k</mi><mi>l</mi></msub><mo>+</mo><mn>1</mn></mrow></mfrac><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><msub><mi>k</mi><mi>l</mi></msub><mo>âˆ’</mo><mn>1</mn></mrow></munderover><msub><mi>Î¾</mi><mrow><mi>l</mi><mo>,</mo><mi>j</mi><mo>+</mo><mi>i</mi></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\begin{equation}
  {CN}_{\boldsymbol{K} = \left\{k_1, k_2\right\}, \boldsymbol{\Xi} = \left\{
  \boldsymbol{\xi}_1,
  \boldsymbol{\xi}_2 \right\}, \boldsymbol{\theta}_{\boldsymbol{\Xi}}} = \left\{ \left( \xi_{1i}^{*},
  \xi_{2j}^{*}, \theta_{ij} \right) \right\}_{i = 1, j =
  1}^{\left\lvert{\boldsymbol{\xi}_1}\right\rvert -
    k_1,
  \left\lvert{\boldsymbol{\xi}_2}\right\rvert - k_2}, \quad \xi^{*}_{lj} = \frac{1}{k_l + 1} \sum_{i = 1}^{k_l - 1}
  \xi_{l, j + i}.
\end{equation}</annotation></semantics></math></p>
<p>Building a control net in the cpr package is done by calling the
<code><a href="../reference/cn.html">cn()</a></code> function after defining a basis via the
<code><a href="../reference/btensor.html">btensor()</a></code> method.</p>
<p>Define a tensor product of B-splines by providing a list of vectors,
iknots, bknots, and orders.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tpmat</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/btensor.html">btensor</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">51</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">51</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          iknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.418</span>, <span class="fl">0.582</span>, <span class="fl">0.676</span>, <span class="fl">0.840</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          bknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>          order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tpmat</span></span>
<span><span class="co">## Tensor Product Matrix dims: [51 x 24]</span></span></code></pre></div>
<p>An example of a control net and the surface it produces:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.03760</span>,  <span class="fl">0.03760</span>, <span class="op">-</span><span class="fl">0.03760</span>,  <span class="fl">0.77579</span>, <span class="op">-</span><span class="fl">0.84546</span>,  <span class="fl">0.63644</span>, <span class="op">-</span><span class="fl">0.87674</span>,</span>
<span>     <span class="fl">0.71007</span>, <span class="op">-</span><span class="fl">1.21007</span>,  <span class="fl">0.29655</span>, <span class="op">-</span><span class="fl">0.57582</span>, <span class="op">-</span><span class="fl">0.26198</span>,  <span class="fl">0.23632</span>, <span class="op">-</span><span class="fl">0.58583</span>,</span>
<span>    <span class="op">-</span><span class="fl">0.46271</span>, <span class="op">-</span><span class="fl">0.39724</span>, <span class="op">-</span><span class="fl">0.02194</span>, <span class="op">-</span><span class="fl">1.23562</span>, <span class="op">-</span><span class="fl">0.19377</span>, <span class="op">-</span><span class="fl">0.27948</span>, <span class="op">-</span><span class="fl">1.14028</span>,</span>
<span>     <span class="fl">0.00405</span>, <span class="op">-</span><span class="fl">0.50405</span>, <span class="op">-</span><span class="fl">0.99595</span><span class="op">)</span></span>
<span></span>
<span><span class="va">acn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cn.html">cn</a></span><span class="op">(</span><span class="va">tpmat</span>, <span class="va">theta</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">acn</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"x2"</span>, zlab <span class="op">=</span> <span class="st">"control net"</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">## Warning in rgl.init(initValue, onlyNULL): RGL: unable to open X11 display</span></span>
<span><span class="co">## Warning: 'rgl.init' failed, will use the null device.</span></span>
<span><span class="co">## See '?rgl.useNULL' for ways to avoid this warning.</span></span>
<span><span class="co">## Warning: no DISPLAY variable so Tk is not available</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">acn</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"x2"</span>, zlab <span class="op">=</span> <span class="st">"surface"</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnr_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level2">
<h2 id="control-net-reduction">Control Net Reduction<a class="anchor" aria-label="anchor" href="#control-net-reduction"></a>
</h2>
<p>Similar to control polygon reduction (CPR), control net reduction
(CNR) looks assesses the influence of each internal knot, omits the
least influential, refits the model, and repeats. A complication for CNR
is that the influence of an internal knot on margin
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
is a function of the locations values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
on the other margins defining the polynomial coefficients. We suggest
using a set of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">p=20</annotation></semantics></math>
values on each margin for assessment.</p>
<p>For example in a two-variable tensor product, the influence weight of
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>j</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">j^{th}</annotation></semantics></math>
internal knot for the first margin is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mrow><mn>1</mn><mi>j</mi></mrow></msub><mo>=</mo><munder><mo>max</mo><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>âˆˆ</mo><mi>ğ”</mi></mrow></munder><msub><mi>w</mi><mrow><mrow><mn>1</mn><mi>j</mi><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>x</mi><mn>2</mn></msub></mrow></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">w_{1j} = \max_{x_2 \in \boldsymbol{U}} w_{\left. 1j \right| x_2},</annotation></semantics></math>
where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ğ”</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mi>u</mi><mo>:</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mfrac><mrow><mo stretchy="true" form="prefix">{</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>â€¦</mi><mo>,</mo><mi>p</mi><mo stretchy="true" form="postfix">}</mo></mrow><mrow><mi>p</mi><mo>+</mo><mn>1</mn></mrow></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mo>max</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>âˆ’</mo><mo>min</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">}</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{U} =
\left\{ u :  \min\left(x_2\right) + \frac{\left\{1,2,\ldots,p\right\}}{p+1} \left( \max\left(x_2\right) - \min\left(x_2\right)\right)
\right\}
</annotation></semantics></math></p>
<p>For example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span> <span class="op">{</span><span class="op">(</span><span class="va">x1</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span> <span class="op">-</span> <span class="va">x1</span> <span class="op">*</span> <span class="va">x2</span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">cn_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cn_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">cn_data</span>, <span class="op">{</span><span class="va">z</span> <span class="op">=</span> <span class="fu">f</span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">initial_cn</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/cn.html">cn</a></span><span class="op">(</span><span class="va">z</span> <span class="op">~</span> <span class="fu"><a href="../reference/btensor.html">btensor</a></span><span class="op">(</span>x        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">x1</span>, <span class="va">x2</span><span class="op">)</span></span>
<span>                 , iknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.234</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.418</span>, <span class="fl">0.582</span>, <span class="fl">0.676</span>, <span class="fl">0.840</span><span class="op">)</span><span class="op">)</span></span>
<span>                 , bknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>                 , order  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span></span>
<span>                 <span class="op">)</span></span>
<span>     , data <span class="op">=</span> <span class="va">cn_data</span><span class="op">)</span></span>
<span><span class="co">## Warning: the 'nobars' function has moved to the reformulas package. Please update your imports, or ask an upstream package maintainter to do so.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once per session.</span></span></span>
<span></span>
<span><span class="fu"><a href="../reference/influence_of_iknots.html">influence_of_iknots</a></span><span class="op">(</span><span class="va">initial_cn</span><span class="op">)</span></span>
<span><span class="co">## [[1]]</span></span>
<span><span class="co">##         xi_4 </span></span>
<span><span class="co">## 5.282465e-32 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## [[2]]</span></span>
<span><span class="co">##        xi_5        xi_6        xi_7        xi_8 </span></span>
<span><span class="co">## 0.717424005 0.045575415 0.006775287 0.012875249 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attr(,"class")</span></span>
<span><span class="co">## [1] "cpr_influence_of_iknots_cpn" "list"</span></span></code></pre></div>
<p>The least influential knot is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Î¾</mi><mrow><mn>1</mn><mo>,</mo><mn>4</mn></mrow></msub><annotation encoding="application/x-tex">\xi_{1,4}</annotation></semantics></math>
and the most influential knot is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Î¾</mi><mrow><mn>2</mn><mo>,</mo><mn>5</mn></mrow></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">\xi_{2,5}.</annotation></semantics></math></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cn1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_bsplines.html">update_btensor</a></span><span class="op">(</span><span class="va">initial_cn</span>, iknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.418</span>, <span class="fl">0.582</span>, <span class="fl">0.676</span>, <span class="fl">0.840</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cn2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_bsplines.html">update_btensor</a></span><span class="op">(</span><span class="va">initial_cn</span>, iknots <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0.234</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.582</span>, <span class="fl">0.676</span>, <span class="fl">0.840</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">initial_cn</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Original"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cn1</span>,        rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">Omitting</span><span class="op">~</span><span class="va">xi</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cn2</span>,        rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">Omitting</span><span class="op">~</span><span class="va">xi</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnr_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" alt="" width="672"></p>
<p>A call to <code><a href="../reference/cnr.html">cnr()</a></code> runs the full CNR algorithm on an
initial control net.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cnr0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cnr.html">cnr</a></span><span class="op">(</span><span class="va">initial_cn</span><span class="op">)</span></span>
<span><span class="co">##   |                                                                              |                                                                      |   0%  |                                                                              |============                                                          |  17%  |                                                                              |=======================                                               |  33%  |                                                                              |===================================                                   |  50%  |                                                                              |===============================================                       |  67%  |                                                                              |==========================================================            |  83%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">)</span></span>
<span><span class="co">##   dfs   loglik        rss         rse n_iknots1 iknots1 n_iknots2      iknots2</span></span>
<span><span class="co">## 1  12 12396.78 49.0631393 0.070087150         0                 0             </span></span>
<span><span class="co">## 2  15 12408.53 48.9479832 0.070015367         0                 1        0.582</span></span>
<span><span class="co">## 3  18 36554.82  0.3912139 0.006260346         0                 2 0.418, 0.582</span></span>
<span><span class="co">## 4  21 36559.88  0.3908179 0.006258118         0                 3 0.418, 0....</span></span>
<span><span class="co">## 5  24 38449.23  0.2678356 0.005181505         0                 4 0.418, 0....</span></span>
<span><span class="co">## 6  32 38449.23  0.2678356 0.005183584         1   0.234         4 0.418, 0....</span></span>
<span><span class="co">##   index</span></span>
<span><span class="co">## 1     1</span></span>
<span><span class="co">## 2     2</span></span>
<span><span class="co">## 3     3</span></span>
<span><span class="co">## 4     4</span></span>
<span><span class="co">## 5     5</span></span>
<span><span class="co">## 6     6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnr_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" alt="" width="700"></p>
<p>The plot of the residual standard errors by index shows index 3 is
the preferable model. We can look at all the surfaces and see there is
little difference from the original (index 6) through index 3 with
considerable differences in the surfaces for index 1 and 2.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 1"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 2"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 3"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 4"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 5"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cnr0</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>, rgl <span class="op">=</span> <span class="cn">FALSE</span>, show_surface <span class="op">=</span> <span class="cn">TRUE</span>, show_net <span class="op">=</span> <span class="cn">FALSE</span>, clim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.2</span>, <span class="fl">0.3</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Index 6"</span>, colkey <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="cnr_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs">

</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">## R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] cpr_0.4.1     qwraps2_0.6.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] generics_0.1.4     sass_0.4.10        tcltk_4.5.2        lattice_0.22-7    </span></span>
<span><span class="co">##  [5] lme4_1.1-38        digest_0.6.39      magrittr_2.0.4     rgl_1.3.31        </span></span>
<span><span class="co">##  [9] evaluate_1.0.5     grid_4.5.2         RColorBrewer_1.1-3 fastmap_1.2.0     </span></span>
<span><span class="co">## [13] jsonlite_2.0.0     Matrix_1.7-4       misc3d_0.9-1       scales_1.4.0      </span></span>
<span><span class="co">## [17] textshaping_1.0.4  jquerylib_0.1.4    reformulas_0.4.3   Rdpack_2.6.4      </span></span>
<span><span class="co">## [21] cli_3.6.5          rlang_1.1.6        rbibutils_2.4      splines_4.5.2     </span></span>
<span><span class="co">## [25] withr_3.0.2        base64enc_0.1-3    cachem_1.1.0       yaml_2.3.12       </span></span>
<span><span class="co">## [29] otel_0.2.0         tools_4.5.2        nloptr_2.2.1       minqa_1.2.8       </span></span>
<span><span class="co">## [33] dplyr_1.1.4        ggplot2_4.0.1      boot_1.3-32        vctrs_0.6.5       </span></span>
<span><span class="co">## [37] R6_2.6.1           lifecycle_1.0.4    plot3D_1.4.2       fs_1.6.6          </span></span>
<span><span class="co">## [41] htmlwidgets_1.6.4  MASS_7.3-65        ragg_1.5.0         pkgconfig_2.0.3   </span></span>
<span><span class="co">## [45] desc_1.4.3         pillar_1.11.1      pkgdown_2.2.0      bslib_0.9.0       </span></span>
<span><span class="co">## [49] gtable_0.3.6       glue_1.8.0         Rcpp_1.1.0         systemfonts_1.3.1 </span></span>
<span><span class="co">## [53] tidyselect_1.2.1   tibble_3.3.0       xfun_0.55          knitr_1.51        </span></span>
<span><span class="co">## [57] farver_2.1.2       htmltools_0.5.9    nlme_3.1-168       labeling_0.4.3    </span></span>
<span><span class="co">## [61] rmarkdown_2.30     compiler_4.5.2     S7_0.2.1</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Peter DeWitt.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
