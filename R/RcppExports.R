# This file was generated by Rcpp::compileAttributes
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Knot Insertion, Removal, and Reinsertion
#' 
#' Functions for the insertion, removal, and reinsertion of internal knots for
#' B-splines.
#'
#' \code{refine_ordinate} provides the estimated ordinates of the control
#' polygon's vertex sequence after inserting the value \code{x} into the knot
#' vector \code{xi}.
#'
#' \code{coarsen_ordinate} provides the estimated ordinates of the control
#' polygon's vertex sequence after the removal of the the value \code{x} from the
#' knot vector \code{xi}.  The expected input for this function is the value
#' \code{x} to insert into \code{xi}.  That is, to find the estimate of the
#' coarsened ordinates by removing the value 2 from the vector (0, 0, 0, 0, 1,
#' 2, 3, 4, 4, 4, 4) (the knot vector for a cubic B-spline with boundary knots
#' at zero and four and internal knots 1, 2, 3) should be specified by
#' \code{coarsen_ordinate(x = 2, xi = c(0, 0, 0, 0, 1, 3, 4, 4, 4, 4), theta)}.
#' See examples.
#'
#' This was done intentionaly such that the overall coding would be similar to
#' the primary reference (SEE MY TO BE PUBLISHED PAPER) where 
#' \eqn{\boldsymbol{W}_{k, \xi} (x)}{W<sub>k, &xi;</sub>(x)} is the knot
#' insertion matrix for inserting \eqn{x} into \eqn{\xi}{&xi;}.
#'
#' The function \code{hat_ordinate} is the coarsen-then-refine estimate of the
#' ordinate vector.  The name comes from the the use of a hat matrix based on the
#' in knot insertion matrix.
#'
#' \code{iknot_weights} returns a vector with the 'importance weight' of each
#' of the internal knots in \code{xi}.
#'
#' @param x the value of the knot to be inserted into the knot vector
#' @param xi the (whole) knot vector, including the repeated boundary knots.
#'   Regardless of refinement or coarsening, this vector should be the
#'   'reduced' vector such that x will be added to it.  See details and
#'   examples.
#' @param theta the ordinates of the control polygon vertices
#' @param order the order of the B-spline, defaults to 4 for cubic splines
#'
#' @return numeric vectors
#'
#' @export
#' @rdname boehm
refine_ordinate <- function(x, xi, theta, order = 4L) {
    .Call('cpr_refine_ordinate', PACKAGE = 'cpr', x, xi, theta, order)
}

#' @export
#' @rdname boehm
coarsen_ordinate <- function(x, xi, theta, order = 4L) {
    .Call('cpr_coarsen_ordinate', PACKAGE = 'cpr', x, xi, theta, order)
}

#' @export
#' @rdname boehm
hat_ordinate <- function(x, xi, theta, order = 4L) {
    .Call('cpr_hat_ordinate', PACKAGE = 'cpr', x, xi, theta, order)
}

#' @export
#' @rdname boehm
insertion_matrix <- function(x, xi, order = 4L) {
    .Call('cpr_insertion_matrix', PACKAGE = 'cpr', x, xi, order)
}

weigh_iknots <- function(xi, theta, order = 4L, p = 2L) {
    .Call('cpr_weigh_iknots', PACKAGE = 'cpr', xi, theta, order, p)
}

greville_sites <- function(xi, order) {
    .Call('cpr_greville_sites', PACKAGE = 'cpr', xi, order)
}

bspline__impl <- function(x, j, order, knots) {
    .Call('cpr_bspline__impl', PACKAGE = 'cpr', x, j, order, knots)
}

bbasis__impl <- function(x, iknots, bknots, k) {
    .Call('cpr_bbasis__impl', PACKAGE = 'cpr', x, iknots, bknots, k)
}

diag_only <- function(A, B) {
    .Call('cpr_diag_only', PACKAGE = 'cpr', A, B)
}

tp__impl <- function(A, B) {
    .Call('cpr_tp__impl', PACKAGE = 'cpr', A, B)
}

